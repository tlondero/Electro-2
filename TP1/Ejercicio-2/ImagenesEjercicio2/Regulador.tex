\input{Header-Stda.tex}

\begin{document}

%Circuito
\begin{page}
\begin{circuitikz}[european voltages]

	%Amplificador error
	\node[color = blue] [op amp, yscale=-1](A){};
	\draw[color = blue]
		(A.+) -- ++(-1,0) node[ground](g1){}
		(A.down) -- ++ (0,0.5) node[ocirc, label=north:$V^{-}$](){}    
		(A.up) -- ++ (0,-0.5) node[ocirc, label=south:$V^{+}$](){}
		(A.-) -- ++ (0,-2.55) node[ocirc](aux1){}
		(A.out) -- ++ (1,0) node[ocirc](aux2){}
		;
		
	%Circuito de protección
	\draw[color = orange]
		(aux2.south) |- ++ (2,-2) node[npn, anchor=C, rotate = 90, xscale=-1, label=below:$Q_3$](Q3){}
		(Q3.B) -- ++(0,1.16) to[R, l_=$R_C$] ++ (-2,0) node[ground](){}
		(Q3.E) -- ++(1.5,0) node[](aux4){} to[R, l_=$R_A$] ++ (0,2) node[](aux3){} to[R, l_=$R_B$] ++ (-2,0) -| (Q3.B)
		(aux4.center) -- ++ (0,-1) node[ocirc](aux6){}		
		;
		
	%Transistor de paso
	\draw[color = olive]
		(aux2.north) -- ++ (0,3) node[npn, anchor = E, label=right:$Q_1$](Q1){}
		(Q1.C) -- ++ (2,0) node[npn, anchor = B, label=right:$Q_2$](Q2){} 	
		($ (Q1.C) !.5! (Q2) $) to[R, l=$R_5$] ++(0,-3) -- ++ (3.6,0)
		(Q2.E) -| (aux3.center)
		(Q1.B) -- ++ (0,2) node[ocirc](aux5){}
		(Q2.C) |- (aux5.east)
		;
				
	%Circuito de detección (Realimentador)
	\draw[color = purple]
		(aux6.west) to[R, l_=$R_1$] (aux1.east)
		;
		
	%Elemento de referencia
	\draw[color = red]
		(aux1.west) to[R, l_=$R_2$] ++ (-2,0) node[](aux7){} to[R, l_=$R_Z$] ++ (-2,0) node[ocirc](aux8){}
		(aux7.center) to[zzDo] ++ (0,-1.5) node[ground](){}
		;
	
	%Fuentes
	\draw
		(aux8.north) to[open] ++ (0,4.5) node[](aux9){} -- ++ (1,0) node[ground](){}
		(aux9.center) to[battery2, l_=$V^{-}$] (aux8.north)
		(aux9.center) ++ (0,3) to[battery2, l_=$V^{+}$] ++ (0,-3) ++ (0,3) |- (aux5.west)

		;	
	
	
	%Carga
	\draw[color = brown]
		(aux6.south) to[R, l=$R_L$] ++ (0,-2) node[ground](){}
		;		
\end{circuitikz}
\end{page}

\end{document}